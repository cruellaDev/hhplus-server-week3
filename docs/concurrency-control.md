# 동시성 제어 전략

> 💡이전 주 과제 피드백 반영과 관련하여 리팩토링을 마치지 못하여 동시성 테스트를 할 수 없었습니다.

> 💡비즈니스를 고려하여 계획한 동시성 제어 전략만 아래 작성하였습니다.

## 결제 요청 및 포인트 사용
결제 버튼 '따닥' 이슈를 고려해야 합니다. 사용자 한 명이 요청한 횟수에 따라 트랜잭션이 생성될 것이고 결제가 완료되면 예약 정보의 예약 상태가 변경되기 때문에 이후 들어오는 요청의 경우 결제 가능 예약 상태 검증을 통과하지 못하고 배제되는 게 더 효율적이라 생각합니다. 따라서 비관적 락이 적합하다고 봅니다.


## 좌석 예약
현재 대기열 활성화는 50명으로 제한되어있고 비즈니스 상 좌석에 대해 조회는 가능하되 가장 먼저 락을 건 사용자만 좌석 선점을 할 수 있고 그 외 사용자는 좌석 선점을 실패시킨다고 했을 때 낙관적 락이 제일 적합해 보였습니다.

## 그외
### 대기열
대기열 토큰값이 unique 하고 대기열 발급은 insert 로만 수행되기 때문에 락이 필요가 없다고 판단하였습니다.

## 추후 계획
현재 은행 창구 방식으로 대기열 진입을 구현 중이나 추후 대용량 트래픽을 고려하여 놀이공원 방식으로 바꿀 예정입니다.
DB에 과도한 접근을 줄이면서 TTL을 설정할 수 있다는 점에서 분산락을 사용할 예정입니다